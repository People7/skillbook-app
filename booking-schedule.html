<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Booking & Schedule - Skillbook</title>
  <style>
    /* Keep your existing CSS here */
  </style>
</head>
<body>
<nav style="background-color:#065f46; padding: 2rem;">
  <ul style="list-style: none; display: flex; flex-wrap: wrap; justify-content: center; gap: 2rem; margin: 0; padding: 0;">
    <li><a href="index.html" style="color: white; text-decoration: none;">Home</a></li>
    <li><a href="upcoming-bookings.html" style="color: white; text-decoration: none;">Upcoming Bookings</a></li>
    <li><a href="notifications.html" style="color: white; text-decoration: none;">Notifications</a></li>
    <li><a href="service-details.html" style="color: white; text-decoration: none;">Service Details</a></li>
  </ul>
</nav>

<h1>Booking & Schedule</h1>

<div class="booking-card">
  <h3>Service: Personal Fitness Training</h3>
  <p><strong>Client:</strong> John Doe</p>
  <p><strong>Date:</strong> April 12, 2025</p>
  <p><strong>Time:</strong> 10:00 AM</p>
  <p><strong>Location:</strong> Downtown Gym, NY</p>
  <p><strong>Client Note:</strong> Please bring resistance bands if possible.</p>
  <p class="status">Status: Pending</p>
  <div class="btn-group">
    <button class="btn accept" onclick="handleResponse(this, 'Accepted')">Accept</button>
    <button class="btn decline" onclick="handleResponse(this, 'Declined')">Decline</button>
    <button class="btn whatsapp" onclick="contactWhatsApp('1234567890')">WhatsApp</button>
  </div>
</div>

<div class="schedule-form">
  <h2>Set Your Availability</h2>
  <form id="availability-form">
    <label for="day">Available Day(s)</label>
    <select id="day" multiple>
      <option>Monday</option>
      <option>Tuesday</option>
      <option>Wednesday</option>
      <option>Thursday</option>
      <option>Friday</option>
      <option>Saturday</option>
      <option>Sunday</option>
    </select>

    <label for="start-time">Start Time</label>
    <input type="time" id="start-time" />

    <label for="end-time">End Time</label>
    <input type="time" id="end-time" />

    <label for="duration">Session Duration (mins)</label>
    <input type="number" id="duration" placeholder="e.g. 60" />

    <label for="note">Additional Notes (Optional)</label>
    <textarea id="note" rows="3" placeholder="Mention preferences or unavailable dates..."></textarea>

    <button type="submit">Save Availability</button>
  </form>
</div>

<script type="module">
  import { auth } from './firebase.js';

  // Example check:
  console.log('Firebase Auth ready:', auth);
</script>


  document.getElementById('availability-form').addEventListener('submit', async (e) => {
    e.preventDefault();

    const selectedDays = Array.from(document.getElementById('day').selectedOptions).map(opt => opt.value);
    const startTime = document.getElementById('start-time').value;
    const endTime = document.getElementById('end-time').value;
    const duration = document.getElementById('duration').value;
    const note = document.getElementById('note').value;

    try {
      await addDoc(collection(db, "availabilities"), {
        days: selectedDays,
        startTime,
        endTime,
        duration,
        note,
        timestamp: new Date()
      });
      alert("Availability saved!");
      document.getElementById("availability-form").reset();
    } catch (err) {
      console.error("Error saving availability:", err);
      alert("Failed to save availability.");
    }
  });

  window.handleResponse = function(el, status) {
    const card = el.closest('.booking-card');
    card.querySelector('.status').textContent = 'Status: ' + status;
    el.parentElement.querySelectorAll('.btn').forEach(btn => btn.disabled = true);
  }

  window.contactWhatsApp = function(number) {
    window.open(`https://wa.me/${number}`, '_blank');
  }

  onAuthStateChanged(auth, user => {
    if (user) {
      console.log("Logged in as:", user.email);
    } else {
      console.log("User not logged in.");
    }
  });
</script>

</body>
</html>
